<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>플레이 기록 등록</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/custom.css}">
</head>

<body class="bg-background text-foreground">
<!-- ✅ 공통 대시보드 헤더 -->
<div th:replace="fragments/dashboardHeader :: dashboard-header('records')"></div>

<main class="container py-5" style="max-width:960px;">
    <h2 class="mb-1 fw-bold">🔒 플레이 기록 등록</h2>

    <!-- 현재 로그인한 멤버 표시 (선택 UI는 X) -->
    <p class="text-muted mb-4">
        현재 로그인:
        <span th:text="${session.loginMember != null ? session.loginMember.name : '알 수 없음'}">홍성균</span>
    </p>

    <!-- ✅ action: /playRecords/new -->
    <form th:action="@{/playRecords/new}" th:object="${playRecordForm}" method="post"
          class="border p-4 rounded bg-card shadow-sm">

        <!-- 플레이 날짜 -->
        <div class="mb-3">
            <label for="playDate" class="form-label fw-semibold">플레이 날짜</label>
            <input type="date" id="playDate" th:field="*{playDate}" class="form-control">
            <div class="text-danger small"
                 th:if="${#fields.hasErrors('playDate')}"
                 th:errors="*{playDate}"></div>
        </div>

        <!-- 테마 선택 -->
        <div class="mb-3">
            <label for="themeId" class="form-label fw-semibold">테마</label>
            <select id="themeId" th:field="*{themeId}" class="form-select">
                <option value="" disabled
                        th:selected="${playRecordForm.themeId == null}">
                    테마를 선택하세요
                </option>
                <option th:each="t : ${themes}"
                        th:value="${t.id}"
                        th:text="${t.title}"></option>
            </select>
            <div class="text-danger small"
                 th:if="${#fields.hasErrors('themeId')}"
                 th:errors="*{themeId}"></div>
        </div>

        <!-- 결과 / 클리어 시간 / 힌트 / 평점 -->
        <div class="row g-3 mt-1">

            <!-- 성공 여부 -->
            <div class="col-md-3 d-flex align-items-center">
                <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="cleared" th:field="*{cleared}">
                    <label class="form-check-label fw-semibold" for="cleared">
                        성공 여부 (성공이면 체크)
                    </label>
                </div>
                <div class="text-danger small ms-2"
                     th:if="${#fields.hasErrors('cleared')}"
                     th:errors="*{cleared}"></div>
            </div>

            <!-- 클리어 시간: 분 / 초 분리 -->
            <div class="col-md-3">
                <label class="form-label fw-semibold">클리어 시간</label>
                <div class="d-flex align-items-center gap-2">
                    <input type="number"
                           class="form-control"
                           style="max-width: 90px;"
                           id="clearMinutes"
                           th:field="*{clearMinutes}"
                           min="0" placeholder="분">
                    <span class="small text-muted">분</span>

                    <input type="number"
                           class="form-control"
                           style="max-width: 90px;"
                           id="clearSeconds"
                           th:field="*{clearSeconds}"
                           min="0" max="59" placeholder="초">
                    <span class="small text-muted">초</span>
                </div>

                <!-- 분/초 각각 에러 출력 -->
                <div class="text-danger small mt-1"
                     th:if="${#fields.hasErrors('clearMinutes')}"
                     th:errors="*{clearMinutes}"></div>
                <div class="text-danger small"
                     th:if="${#fields.hasErrors('clearSeconds')}"
                     th:errors="*{clearSeconds}"></div>
            </div>

            <!-- 힌트 사용 개수 -->
            <div class="col-md-3">
                <label for="hintCount" class="form-label fw-semibold">힌트 사용 개수</label>
                <input type="number" id="hintCount" th:field="*{hintCount}"
                       class="form-control" placeholder="예: 2">
                <div class="text-danger small"
                     th:if="${#fields.hasErrors('hintCount')}"
                     th:errors="*{hintCount}"></div>
            </div>

            <!-- 평점 -->
            <div class="col-md-3">
                <label for="rating" class="form-label fw-semibold">평점 (1~5)</label>
                <input type="number" id="rating" th:field="*{rating}"
                       min="1" max="5" class="form-control" placeholder="예: 4">
                <div class="text-danger small"
                     th:if="${#fields.hasErrors('rating')}"
                     th:errors="*{rating}"></div>
            </div>
        </div>

        <!-- 한줄평 -->
        <div class="mt-3">
            <label for="comment" class="form-label fw-semibold">한줄평 / 코멘트</label>
            <textarea id="comment" th:field="*{comment}" rows="3"
                      class="form-control"
                      placeholder="오늘 플레이한 후기나 느낌을 간단히 남겨보세요."></textarea>
            <div class="text-danger small"
                 th:if="${#fields.hasErrors('comment')}"
                 th:errors="*{comment}"></div>
        </div>

        <div class="d-flex justify-content-between mt-4">
            <a th:href="@{/playRecords}" class="btn btn-outline-secondary">목록으로</a>
            <button type="submit" class="btn btn-primary">등록하기</button>
        </div>
    </form>
</main>
</body>
</html>
